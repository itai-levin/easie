# EASIE - Exploration of chemical Analog Space, Implicitly and Explicitly

This repository contains the code described in [Computer-aided evaluation and exploration of chemical spaces constrained by reaction pathways](https://aiche.onlinelibrary.wiley.com/doi/full/10.1002/aic.18234)

## Usage:
#### 1. Set up Conda environment 
a. Initialize the Conda environment: `conda env create --file environment.yml`
b. Activate the Conda environment `conda activate easie`

#### 2. Download the ASKCOS building block database:
a. `cd easie/building_blocks`
b. `wget https://github.com/ASKCOS/askcos-data/blob/main/buyables/buyables.json.gz`

#### 3a. Run implicit/explicit enumeration from a manually defined route
To count the number of analogs or perform an explicit enumeration for a manually defined route, use `count_analogs.py` or `enumerate_analogs.py`, respectively. 
Manually defined routes should be written into a file as a list of reaction SMILES with double quotation marks, separated by commas. See `data/mitapivat_experimental_route.txt` as an example input file. The order of the reactions does not matter.

For example calls and usage examples, see `exmample_from_manual_route.ipynb`.

#### 3b. Run implicit/explicit enumeration from routes returned by ASKCOS
To count the number of analogs or perform an explicit enumeration for routes generated by ASKCOS use `count_analogs_askcos_route.py` or `enumerate_analogs_askcos_route.py`, respectively. 
To generate routes from ASKCOS in the appropariate format, use the script `easie/run_askcos/query_askcos.py`. Example input files for querying ASKCOS are provided in the `easie/run_askcos` directory. This will require a separate deployment of [ASKCOS](https://github.com/ASKCOS). An example output file is provided at `data/valsartan_routes.json`.

For example calls and usage examples, see `exmample_from_ASKCOS_route.ipynb`.

## How to cite:
Levin, I, Fortunato, ME, Tan, KL, Coley, CW. Computer-aided evaluation and exploration of chemical spaces constrained by reaction pathways. AIChE J. 2023;e18234. [doi:10.1002/aic.18234](https://doi.org/10.1002/aic.18234)


Code contributors: Itai Levin and Michael Fortunato
